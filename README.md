<h1>Video2Property</h1>
We use NeRF to reconstruct a 3D scene from images and extract a mesh from the reconstructed scene. Points are sampled from this mesh to serve as the initial positions for a Material Point Method (MPM) simulation. The simulation is then run with variables such as actuator velocity or friction angle, and the final state is rendered as an image. We compare this simulated image with the one generated by NeRF and compute a loss based on the image differences. Finally, we optimize the simulation variables by minimizing the image loss.

<img width="982" alt="v2p_framework" src="https://github.com/user-attachments/assets/17477635-9874-4f46-9842-394bc82bf0dc">

<h1>Run script</h1>

Running `python run_inverse.py` will optimize the friction angle using `scipy.optimize.minimize`. You can choose a gradient-based method like `BFGS` or a gradient-free method like `Nelder-Mead` for the optimization. However, we found that gradient-based approaches may not be effective for this problem. The loss computed from the image is non-deterministic because rendering involves sampling pixel colors, which leads to instability in the gradients.

![Nelder-Mead_animation](https://github.com/chhsiao93/inverse_fd/blob/main/data/BFGS_animation.gif)

Therefore, we suggest use Bayesian optimization by running `python run_bo.py`. The Bayesian optimization descibe the function in a probabilistic way. We start with 5 random evaluation points as the prior. And then, we use acquistion function ('EI','LCB',or 'PI') to find the next evaluation point and update the function. 

![BO-phi-mse](https://github.com/chhsiao93/inverse_fd/blob/main/result/bo_phi_mse.gif)


